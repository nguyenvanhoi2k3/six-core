const t=(t,i,e)=>Math.max(t,Math.min(i,e));class i{isActive=!1;value=0;from=0;to=0;lerp=.1;duration;easing;currentTime=0;onUpdate;onStart;advance(i){if(!this.isActive)return;let e=!1;if(this.duration&&this.easing){this.currentTime+=i;const l=t(0,this.currentTime/this.duration,1);e=l>=1;const s=e?1:this.easing(l);this.value=this.from+(this.to-this.from)*s}else this.value=(l=this.value,s=this.to,o=60*this.lerp,c=i,r=l,h=s,(1-(n=1-Math.exp(-o*c)))*r+n*h),e=Math.abs(this.value-this.to)<.01||Math.round(this.value)===this.to;var l,s,o,c,r,h,n;e&&(this.value=this.to,this.isActive=!1),this.onUpdate?.(this.value,e)}cancel(){this.isActive=!1,this.currentTime=0}fromTo(t,i,{lerp:e=.1,duration:l,easing:s,onStart:o,onUpdate:c}){"function"==typeof s&&"number"!=typeof l&&(l=1),this.from=this.value=t,this.to=i,this.lerp=e,this.duration=l,this.easing=s,this.currentTime=0,this.onStart=o,this.onUpdate=c,this.isActive=!0,this.onStart?.()}}class e{el;options;callback;touch={x:0,y:0};lastDelta={x:0,y:0};static LINE_HEIGHT=16.66;constructor(t,i={}){this.el=t,this.options={wheelMultiplier:i.wheelMultiplier??1,touchMultiplier:i.touchMultiplier??1},this.el.addEventListener("wheel",this.onWheel,{passive:!1}),this.el.addEventListener("touchstart",this.onTouchStart,{passive:!0}),this.el.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this.el.addEventListener("touchend",this.onTouchEnd,{passive:!0})}on(t,i){"scroll"===t&&(this.callback=i)}checkNestedScroll(t,i,e){const l=window.getComputedStyle(t),s=["auto","scroll"].includes(l.overflowX),o=["auto","scroll"].includes(l.overflowY);if(!s&&!o)return!1;const{scrollWidth:c,scrollHeight:r,clientWidth:h,clientHeight:n}=t,a=c>h,d=r>n;if(!a&&!d)return!1;if(0!==e&&o&&d){const i=t.scrollTop;return e>0&&i<r-n||e<0&&i>0}if(0!==i&&s&&a){const e=t.scrollLeft;return i>0&&e<c-h||i<0&&e>0}return!1}onWheel=t=>{if(t.composedPath().some(i=>i instanceof HTMLElement&&this.checkNestedScroll(i,t.deltaX,t.deltaY)))return;t.preventDefault();let i=t.deltaX,l=t.deltaY;const s=t.deltaMode,o=1===s?e.LINE_HEIGHT:2===s?window.innerWidth:1,c=1===s?e.LINE_HEIGHT:2===s?window.innerHeight:1;i*=o*this.options.wheelMultiplier,l*=c*this.options.wheelMultiplier,this.callback?.({deltaX:i,deltaY:l,event:t})};onTouchStart=t=>{const i=t.touches[0];this.touch.x=i.clientX,this.touch.y=i.clientY,this.lastDelta={x:0,y:0},this.callback?.({deltaX:0,deltaY:0,event:t})};onTouchMove=t=>{const i=t.touches[0],e=-(i.clientX-this.touch.x)*this.options.touchMultiplier,l=-(i.clientY-this.touch.y)*this.options.touchMultiplier;t.composedPath().some(t=>t instanceof HTMLElement&&this.checkNestedScroll(t,e,l))||(this.touch.x=i.clientX,this.touch.y=i.clientY,this.lastDelta={x:e,y:l},t.preventDefault(),this.callback?.({deltaX:e,deltaY:l,event:t}))};onTouchEnd=t=>{this.callback?.({deltaX:this.lastDelta.x,deltaY:this.lastDelta.y,event:t})};destroy(){this.el.removeEventListener("wheel",this.onWheel),this.el.removeEventListener("touchstart",this.onTouchStart),this.el.removeEventListener("touchmove",this.onTouchMove),this.el.removeEventListener("touchend",this.onTouchEnd),this.callback=void 0}}class l{events={};on(t,i){if("function"!=typeof i)throw new Error(`Callback for event "${t}" must be a function`);return this.events[t]||(this.events[t]=[]),this.events[t].push(i),()=>this.off(t,i)}off(t,i){this.events[t]&&(this.events[t]=this.events[t].filter(t=>t!==i))}emit(t,...i){const e=this.events[t];e&&[...e].forEach(t=>t(...i))}destroy(){this.events=Object.create(null)}}class s{isEnabled=!0;isScrolling=!1;targetScroll=0;animatedScroll=0;velocity=0;lastVelocity=0;direction=0;scrollTween=new i;hookSystem=new l;scrollHandle=null;time=0;preventNextNativeScroll=!1;options;rafId=null;resetVelocityTimeout=null;constructor({mouseScrollScale:t=1,touchScrollScale:i=3,lerp:l=.13,disableOnMobile:s=!0,loop:o=!1}={}){this.options={mouseScrollScale:t,touchScrollScale:i,lerp:l,disableOnMobile:s,loop:o},s&&"undefined"!=typeof window&&/Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent)?this.isEnabled=!1:(this.animatedScroll=this.targetScroll=this.getActualScroll(),this.scrollHandle=new e(document.documentElement,{wheelMultiplier:t,touchMultiplier:i}),window.addEventListener("scroll",this.onNativeScroll,{passive:!0}),this.scrollHandle.on("scroll",({deltaY:t,event:i})=>{i.type.includes("touch")&&(this.isScrolling="smooth"),i.preventDefault(),!this.options.loop&&this.targetScroll<=0&&t<0||this.scrollTo(this.targetScroll+t,{programmatic:!1})}))}get scroll(){return this.options.loop?(t=this.animatedScroll,i=this.limit,(t%i+i)%i):this.animatedScroll;var t,i}get isAtTop(){return Math.abs(this.scroll)<.01}get limit(){return document.documentElement.scrollHeight-window.innerHeight}getActualScroll(){return window.scrollY}setScroll(t){window.scrollTo({top:t,behavior:"instant"})}reset(){this.resetVelocityTimeout&&(clearTimeout(this.resetVelocityTimeout),this.resetVelocityTimeout=null),this.isScrolling=!1,this.animatedScroll=this.targetScroll=this.getActualScroll(),this.lastVelocity=this.velocity,this.velocity=0,this.direction=0,this.scrollTween.cancel(),this.hookSystem.emit("scroll",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction}),requestAnimationFrame(()=>{this.hookSystem.emit("scrollend",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction})})}onNativeScroll=()=>{if(this.preventNextNativeScroll)this.preventNextNativeScroll=!1;else if(!1===this.isScrolling||"native"===this.isScrolling){const t=this.animatedScroll;this.animatedScroll=this.targetScroll=this.getActualScroll(),this.lastVelocity=this.velocity,this.velocity=this.animatedScroll-t,this.direction=Math.sign(this.velocity),this.isScrolling="native",this.hookSystem.emit("scroll",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction}),0!==this.velocity&&(this.resetVelocityTimeout=setTimeout(()=>{this.lastVelocity=this.velocity,this.velocity=0,this.isScrolling=!1,this.hookSystem.emit("scroll",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction})},400))}};preventNextNativeScrollEvent(){this.preventNextNativeScroll=!0,requestAnimationFrame(()=>{this.preventNextNativeScroll=!1})}scrollTo(i,{offset:e=0,immediate:l=!1,programmatic:s=!0,lerp:o=this.options.lerp}={}){if(this.isEnabled){if("string"==typeof i&&"top"===i)i=0;else if("string"==typeof i&&"bottom"===i)i=this.limit;else if("string"==typeof i){const t=document.querySelector(i);if(!(t instanceof HTMLElement))return;i=t.getBoundingClientRect().top+this.scroll}else i instanceof HTMLElement&&(i=i.getBoundingClientRect().top+this.scroll);if("number"==typeof i){if(i=Math.round(i+e),this.options.loop){if(s){this.targetScroll=this.animatedScroll=this.scroll;const t=this.limit,e=i-this.animatedScroll;e>t/2?i-=t:e<-t/2&&(i+=t)}}else i=t(0,i,this.limit);if(i!==this.targetScroll){if(l)return this.animatedScroll=this.targetScroll=i,this.setScroll(this.scroll),this.scrollTween.cancel(),this.hookSystem.emit("scroll",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction}),this.preventNextNativeScrollEvent(),void requestAnimationFrame(()=>{this.hookSystem.emit("scrollend",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction})});s||(this.targetScroll=i),this.scrollTween.fromTo(this.animatedScroll,this.targetScroll,{lerp:o,onStart:()=>{this.isScrolling="smooth"},onUpdate:(t,i)=>{this.lastVelocity=this.velocity,this.velocity=t-this.animatedScroll,this.direction=Math.sign(this.velocity),this.animatedScroll=t,this.setScroll(this.scroll),this.hookSystem.emit("scroll",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction}),i&&(this.isScrolling=!1,this.animatedScroll=this.targetScroll,this.setScroll(this.scroll),this.scrollTween.cancel(),this.hookSystem.emit("scroll",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction}),requestAnimationFrame(()=>{this.hookSystem.emit("scrollend",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction})}),this.preventNextNativeScrollEvent())}})}}}}loop=t=>{this.raf(t),this.rafId=requestAnimationFrame(this.loop)};start(){this.isEnabled&&(this.reset(),this.rafId=requestAnimationFrame(this.loop))}stop(){null!==this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.reset()}destroy(){this.stop(),this.scrollHandle&&(this.scrollHandle.destroy(),this.scrollHandle=null),window.removeEventListener("scroll",this.onNativeScroll),this.hookSystem.destroy()}raf(t){const i=Math.min(.001*(t-this.time),.1);this.time=t,this.scrollTween.advance(i)}on(t,i){return this.isEnabled?this.hookSystem.on(t,i):()=>{}}}export{s as SmoothScroll};
//# sourceMappingURL=six-core.esm.min.js.map
