!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["six-core"]={})}(this,function(t){"use strict";const e=(t,e,i)=>Math.max(t,Math.min(e,i));class i{isActive=!1;value=0;from=0;to=0;lerp=.1;duration;easing;currentTime=0;onUpdate;onStart;advance(t){if(!this.isActive)return;let i=!1;if(this.duration&&this.easing){this.currentTime+=t;const l=e(0,this.currentTime/this.duration,1);i=l>=1;const s=i?1:this.easing(l);this.value=this.from+(this.to-this.from)*s}else this.value=(l=this.value,s=this.to,o=60*this.lerp,c=t,r=l,n=s,(1-(h=1-Math.exp(-o*c)))*r+h*n),i=Math.abs(this.value-this.to)<.01||Math.round(this.value)===this.to;var l,s,o,c,r,n,h;i&&(this.value=this.to,this.isActive=!1),this.onUpdate?.(this.value,i)}cancel(){this.isActive=!1,this.currentTime=0}fromTo(t,e,{lerp:i=.1,duration:l,easing:s,onStart:o,onUpdate:c}){"function"==typeof s&&"number"!=typeof l&&(l=1),this.from=this.value=t,this.to=e,this.lerp=i,this.duration=l,this.easing=s,this.currentTime=0,this.onStart=o,this.onUpdate=c,this.isActive=!0,this.onStart?.()}}class l{el;options;callback;touch={x:0,y:0};lastDelta={x:0,y:0};static LINE_HEIGHT=16.66;constructor(t,e={}){this.el=t,this.options={wheelMultiplier:e.wheelMultiplier??1,touchMultiplier:e.touchMultiplier??1},this.el.addEventListener("wheel",this.onWheel,{passive:!1}),this.el.addEventListener("touchstart",this.onTouchStart,{passive:!0}),this.el.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this.el.addEventListener("touchend",this.onTouchEnd,{passive:!0})}on(t,e){"scroll"===t&&(this.callback=e)}checkNestedScroll(t,e,i){const l=window.getComputedStyle(t),s=["auto","scroll"].includes(l.overflowX),o=["auto","scroll"].includes(l.overflowY);if(!s&&!o)return!1;const{scrollWidth:c,scrollHeight:r,clientWidth:n,clientHeight:h}=t,a=c>n,d=r>h;if(!a&&!d)return!1;if(0!==i&&o&&d){const e=t.scrollTop;return i>0&&e<r-h||i<0&&e>0}if(0!==e&&s&&a){const i=t.scrollLeft;return e>0&&i<c-n||e<0&&i>0}return!1}onWheel=t=>{if(t.composedPath().some(e=>e instanceof HTMLElement&&this.checkNestedScroll(e,t.deltaX,t.deltaY)))return;t.preventDefault();let e=t.deltaX,i=t.deltaY;const s=t.deltaMode,o=1===s?l.LINE_HEIGHT:2===s?window.innerWidth:1,c=1===s?l.LINE_HEIGHT:2===s?window.innerHeight:1;e*=o*this.options.wheelMultiplier,i*=c*this.options.wheelMultiplier,this.callback?.({deltaX:e,deltaY:i,event:t})};onTouchStart=t=>{const e=t.touches[0];this.touch.x=e.clientX,this.touch.y=e.clientY,this.lastDelta={x:0,y:0},this.callback?.({deltaX:0,deltaY:0,event:t})};onTouchMove=t=>{const e=t.touches[0],i=-(e.clientX-this.touch.x)*this.options.touchMultiplier,l=-(e.clientY-this.touch.y)*this.options.touchMultiplier;t.composedPath().some(t=>t instanceof HTMLElement&&this.checkNestedScroll(t,i,l))||(this.touch.x=e.clientX,this.touch.y=e.clientY,this.lastDelta={x:i,y:l},t.preventDefault(),this.callback?.({deltaX:i,deltaY:l,event:t}))};onTouchEnd=t=>{this.callback?.({deltaX:this.lastDelta.x,deltaY:this.lastDelta.y,event:t})};destroy(){this.el.removeEventListener("wheel",this.onWheel),this.el.removeEventListener("touchstart",this.onTouchStart),this.el.removeEventListener("touchmove",this.onTouchMove),this.el.removeEventListener("touchend",this.onTouchEnd),this.callback=void 0}}class s{events={};on(t,e){if("function"!=typeof e)throw new Error(`Callback for event "${t}" must be a function`);return this.events[t]||(this.events[t]=[]),this.events[t].push(e),()=>this.off(t,e)}off(t,e){this.events[t]&&(this.events[t]=this.events[t].filter(t=>t!==e))}emit(t,...e){const i=this.events[t];i&&[...i].forEach(t=>t(...e))}destroy(){this.events=Object.create(null)}}t.SmoothScroll=class{isEnabled=!0;isScrolling=!1;targetScroll=0;animatedScroll=0;velocity=0;lastVelocity=0;direction=0;scrollTween=new i;hookSystem=new s;scrollHandle=null;time=0;preventNextNativeScroll=!1;options;rafId=null;resetVelocityTimeout=null;constructor({mouseScrollScale:t=.8,touchScrollScale:e=3,lerp:i=.13,disableOnMobile:s=!0,loop:o=!1}={}){this.options={mouseScrollScale:t,touchScrollScale:e,lerp:i,disableOnMobile:s,loop:o},s&&"undefined"!=typeof window&&/Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent)?this.isEnabled=!1:(this.animatedScroll=this.targetScroll=this.getActualScroll(),this.scrollHandle=new l(document.documentElement,{wheelMultiplier:t,touchMultiplier:e}),window.addEventListener("scroll",this.onNativeScroll,{passive:!0}),this.scrollHandle.on("scroll",({deltaY:t,event:e})=>{e.type.includes("touch")&&(this.isScrolling="smooth"),e.preventDefault(),!this.options.loop&&this.targetScroll<=0&&t<0||this.scrollTo(this.targetScroll+t,{programmatic:!1})}))}get scroll(){return this.options.loop?(t=this.animatedScroll,e=this.limit,(t%e+e)%e):this.animatedScroll;var t,e}get isAtTop(){return Math.abs(this.scroll)<.01}get limit(){return document.documentElement.scrollHeight-window.innerHeight}getActualScroll(){return window.scrollY}setScroll(t){window.scrollTo({top:t,behavior:"instant"})}reset(){this.resetVelocityTimeout&&(clearTimeout(this.resetVelocityTimeout),this.resetVelocityTimeout=null),this.isScrolling=!1,this.animatedScroll=this.targetScroll=this.getActualScroll(),this.lastVelocity=this.velocity,this.velocity=0,this.direction=0,this.scrollTween.cancel(),this.hookSystem.emit("scroll",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction}),requestAnimationFrame(()=>{this.hookSystem.emit("scrollend",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction})})}onNativeScroll=()=>{if(this.preventNextNativeScroll)this.preventNextNativeScroll=!1;else if(!1===this.isScrolling||"native"===this.isScrolling){const t=this.animatedScroll;this.animatedScroll=this.targetScroll=this.getActualScroll(),this.lastVelocity=this.velocity,this.velocity=this.animatedScroll-t,this.direction=Math.sign(this.velocity),this.isScrolling="native",this.hookSystem.emit("scroll",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction}),0!==this.velocity&&(this.resetVelocityTimeout=setTimeout(()=>{this.lastVelocity=this.velocity,this.velocity=0,this.isScrolling=!1,this.hookSystem.emit("scroll",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction})},400))}};preventNextNativeScrollEvent(){this.preventNextNativeScroll=!0,requestAnimationFrame(()=>{this.preventNextNativeScroll=!1})}scrollTo(t,{offset:i=0,immediate:l=!1,programmatic:s=!0,lerp:o=this.options.lerp}={}){if(this.isEnabled){if("string"==typeof t&&"top"===t)t=0;else if("string"==typeof t&&"bottom"===t)t=this.limit;else if("string"==typeof t){const e=document.querySelector(t);if(!(e instanceof HTMLElement))return;t=e.getBoundingClientRect().top+this.scroll}else t instanceof HTMLElement&&(t=t.getBoundingClientRect().top+this.scroll);if("number"==typeof t){if(t=Math.round(t+i),this.options.loop){if(s){this.targetScroll=this.animatedScroll=this.scroll;const e=this.limit,i=t-this.animatedScroll;i>e/2?t-=e:i<-e/2&&(t+=e)}}else t=e(0,t,this.limit);if(t!==this.targetScroll){if(l)return this.animatedScroll=this.targetScroll=t,this.setScroll(this.scroll),this.scrollTween.cancel(),this.hookSystem.emit("scroll",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction}),this.preventNextNativeScrollEvent(),void requestAnimationFrame(()=>{this.hookSystem.emit("scrollend",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction})});s||(this.targetScroll=t),this.scrollTween.fromTo(this.animatedScroll,this.targetScroll,{lerp:o,onStart:()=>{this.isScrolling="smooth"},onUpdate:(t,e)=>{this.lastVelocity=this.velocity,this.velocity=t-this.animatedScroll,this.direction=Math.sign(this.velocity),this.animatedScroll=t,this.setScroll(this.scroll),this.hookSystem.emit("scroll",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction}),e&&(this.isScrolling=!1,this.animatedScroll=this.targetScroll,this.setScroll(this.scroll),this.scrollTween.cancel(),this.hookSystem.emit("scroll",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction}),requestAnimationFrame(()=>{this.hookSystem.emit("scrollend",{scroll:this.scroll,velocity:this.velocity,lastVelocity:this.lastVelocity,direction:this.direction})}),this.preventNextNativeScrollEvent())}})}}}}loop=t=>{this.raf(t),this.rafId=requestAnimationFrame(this.loop)};start(){this.isEnabled&&(this.reset(),this.rafId=requestAnimationFrame(this.loop))}stop(){null!==this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.reset()}destroy(){this.stop(),this.scrollHandle&&(this.scrollHandle.destroy(),this.scrollHandle=null),window.removeEventListener("scroll",this.onNativeScroll),this.hookSystem.destroy()}raf(t){const e=Math.min(.001*(t-this.time),.1);this.time=t,this.scrollTween.advance(e)}on(t,e){return this.isEnabled?this.hookSystem.on(t,e):()=>{}}}});
//# sourceMappingURL=six-core.umd.min.js.map
